# py.detect_movement
Проект анализирует видеопоток с камеры, при обнаружении движения отправляет в телеграм кадр, 
на котором зеленым выделены контуры движущего объекта

===Структура проекта:===
	- папка "src":
        - папка utils
            - config_telegram.py - параметры для телеграм клиента - id, hash
            - telegram_utils.py - код для инициализации и запуска телеграм клиента
        - detect_movement.py: код, связанный с инициализацией детектора движения
        - main.py - основной исполняемый файл
		- stream_setting.py- код, связанный с настройкой, использованием камеры - логины, пароли, url rtsp потоков хранятся в переменных среды, параметрами распознавания движения - размер контуров и ядер.
	- .gitignore - файл, в котором указано то, что не нужно индексировать
requirements.txt - файл зависимостей с указанием версий библиотек
=========================================================================================

====== Параметры для телеграм клиента (задаются в файле src/utils/config_telegram.py)====
api_id - id telegram приложения
api_hash - hash telegram приложения
phone - номер телефона
user_id - id человека или телеграм канала, куда будут отправляться сообщения

- при первом запуске будет необходимо подтвердить вход через Telegram (двухфакторную аутентификацию лучше отключить на это время):
  - в консоли появится сообщение, после которого надо ввести номер телефона, привязанный к Telegram
  - после следующего сообщения ввести код подтверждения Telegram

Для получения api_id и api_hash надо зайти на сайт https://my.telegram.org/apps, зайти в свою учётную запись Telegram и создать приложение
(Create new application).
Следует указать:
- App title - название приложения (неважно какое)
- Short name - сокращённое название (только буквы и цифры, 5-32 символа)
- Platform - указать Other

Остальные поля можно оставить пустыми. Нажать кнопку Create application.
В этот момент зачастую Telegram не пускает вас дальше по непонятным причинам, но главное не сдаваться.
Иногда помогает прокликивание без изменения данных, иногда надо поменять App title или Short name.
После того как ваше приложение будет зарегистрировано откроется следующая страница на которой будут указаны
регистрационные данные вашего приложения. Стоит сохранить все данные в надёжном месте, но для работы парсера
вам понадобятся графы App api_id и App api_hash. Их надо вставить в одноимённые переменные в файле config_telegram.py.
=========================================================================================

====== Параметры для распознавания движения (задаются в файле src/camera_setting.py)=====
contour_size - минимальная площадь контура - объекты меньше этого размера не будут учитываться.
            Если нужно распознавать мелкие объекты, которые далеко, то значение можно выставить в 30. В обычных случаях достаточно значения в 200.

ball_size_for_remove_noises - размер ядра для удаления мелких шумов. Больший размер ядра может уменьшить шум, но может также удалять мелкие детали.
            Маленькие размеры ядер (например, 5) имеет смысл задавать для удаления мелких шумов и деталей. Если задано маленькое ядро, то это помогает сохранить общую структуру объектов и удалить маленькие артефакты.

ball_size_for_for_filling_holes - размер ядра для заполнения внутренних дыр. Нужны, чтобы заполнить внутренние полости объектов, если там дыры и объединить близлежащие объекты в один.
Помогает устранить мелкие отверстия в объектах и сгладить их границы. По умолчанию задано в 8.
=========================================================================================


